<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
	<head>
		<title>Home - Gore Intranet</title>
		
        
        <!-- Import EaselJS Framework -->
		<script src="easeljs/src/easeljs/utils/UID.js"></script>
        <script src="easeljs/src/easeljs/geom/Matrix2D.js"></script>
        <script src="easeljs/src/easeljs/events/MouseEvent.js"></script>
        <script src="easeljs/src/easeljs/display/DisplayObject.js"></script>
        <script src="easeljs/src/easeljs/display/Container.js"></script>
        <script src="easeljs/src/easeljs/display/Text.js"></script>
        <script src="easeljs/src/easeljs/display/Graphics.js"></script>
        <script src="easeljs/src/easeljs/display/Shape.js"></script>
        <script src="easeljs/src/easeljs/display/Stage.js"></script>


		<!-- jQuery template 
		<script id="tileTpl" type="text/x-jquery-tmpl">
			<div class="tile ${size}" style="width:${width}%;height:${height}%;top:${y}%;left:${x}%;" data-id="${id}">
				<a href="#"></a>
			</div>
		</script>
		 /jQuery template -->
         
         <link rel="stylesheet" href="js/plugins/moza/moza.css" type="text/css" charset="utf-8" />
		<!--<link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />-->
		<!--[if lt IE 9]>
		<link rel="stylesheet" href="css/ie7-8.css" type="text/css" charset="utf-8" />
		<![endif]-->
		<!--[if lt IE 7]>
		<link rel="stylesheet" href="css/ie6.css" type="text/css" charset="utf-8" />
		<![endif]-->
		<!-- end jQuery template -->
		<script src="js/libs/jquery-1.6.4.min.js"></script>
		<script src="js/libs/jquery-ui-1.8.15.custom.min.js"></script>
		<script src="js/plugins/jquery.tmpl.js"></script>
		<script src="js/libs/underscore-1.1.7.min.js"></script>
		<script src="js/plugins/moza/moza_modif.js"></script>
		<script>
		
			$(function () {
				$('#testCanvas').showGrid({
					Items: 30,
					random: true,
					tile: {
						big : {
							'max': 1,
							'width': 4,
							'height': 4
						},
						medium : {
							'max': 6,
							'width': 2,
							'height': 2
						},
						small : {
							'max': 10,
							'width': 1,
							'height': 1
						}
					}
				});
			});
			
		</script>
        <style>
		.tile{
        	display:inline-block;
			*display:inline;
			width:50px;
			height:50px;
			background-color:#000;
			text-indent:-55000px;
			margin-right:10px;
		}
        </style>
	</head>
	<body>
	
		
         <div id="canvas"></div>
        <div class="canvasHolder">
			<canvas id="testCanvas" width="1000" height="700"></canvas>
		</div>
   
    
    
    <script>
	
	var sequence = [];
	var level = 3;
	
	function generate_grid(){
		$("#canvas").html("");
		for(i=1;i<=4;i++){
			$("#canvas").append("<div id='"+i+"' class='tile'>x</div>");
		}
	}
	
	function generate_sequence(){
		sequence = [];		
		for(i=1;i<=level;i++){
			var random = Math.round(Math.random()*3) +1;
			sequence.push(random); 
		}
	}
	
	function play_sequence(){
		
			$(sequence).each(function (e){
			
				var timeoutID = window.setTimeout(function(){
					$("#"+sequence[e]).css("backgroundColor","red");
					console.log(sequence[e]);
					}, (e+1)*1000);
				var timeoutID2 = window.setTimeout(function(){
					$("#"+sequence[e]).css("backgroundColor","black");
					
				}, (e+1)*1000+500+((e+1)*100));
				
			});
			
	}
	
	function listen_sequence(current){
		
			$("#canvas div.tile").click(function(){
				if( $(this).attr("id") == sequence[current] ){
					console.log('bravo');
					$("#canvas div.tile").unbind("click");
					current+=1;
					if( current < level ){
						listen_sequence(current);
						
					} else {
						alert("bravo");
						level +=1;
						generate_grid();
	 					generate_sequence();
						play_sequence();
						listen_sequence(0);
					}
				} else {
					$("#canvas div.tile").unbind("click");
					console.log("error : expected:"+sequence[current]);
					alert("error : expected:"+sequence[current]);
					generate_grid();
					generate_sequence();
					play_sequence();
					listen_sequence(0);
				}
			
			
			});
			
	}
	
	$(function() {
		generate_grid();
	 	generate_sequence();
		console.log(sequence);
		play_sequence();
		
		listen_sequence(0);
	});
	
	</script>
	</body>
</html>